<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>view-saloon</title>
    <%- include('../../partials/headlink.ejs') %>
</head>

<body>
    <%- include('../../partials/Header.ejs') %>
        <%- include("../../partials/sidebar.ejs") %>
        <%- include("../../partials/alertMsg") %>

            <main id="main" class="main">
                <div class="pagetitle">

                    <h1><%-user.type %></h1>
                    <nav>
                        <ol class="breadcrumb">
                            <li class="breadcrumb-item"><a href="/">Home</a></li>
                            <li class="breadcrumb-item active">Dashboard</li>
                        </ol>
                    </nav>
                </div>
                <!-- End Page Title -->
                <section class="section dashboard">
                    <div class="row">
                        <div class="row">
                            <div class="col-lg-12">



                                <div class="card">
                                    <div class="card-body">
                                        <h5 class="card-title">Filter</h5>

                                        <!-- No Labels Form -->
                                        <form class="row g-3" action="/all-user">
                                            <div class="col-md-4">
                                                <label>Name</label> <br>
                                                <input type="text" class="form-control" placeholder="Name" name="name"
                                                    value=<%=searchobj.name%>>
                                            </div>
                                            <div class="col-md-4">
                                                <label>Email</label> <br>
                                                <input type="text" class="form-control" placeholder="Email" name="email"
                                                    value=<%=searchobj.email%>>
                                            </div>
                                            <div class="col-md-4">
                                                <label>Mobile No</label> <br>
                                                <input type="text" class="form-control" placeholder="Email"
                                                    name="mobile" value=<%=searchobj.phone%>>
                                            </div>
                                            <div class="col-md-4">
                                                <label>Gender</label> <br>
                                                <input type="text" class="form-control" placeholder="Gender"
                                                    name="gender" value=<%=searchobj.gender%>>
                                            </div>
                                            <div class="col-md-4">
                                                <label for=""></label><br>
                                                    <select name="status" id="" class="form-control">
                                                        <option value="" disabled selected>select status</option>
                                                        <option value="user"  <%=searchobj.status=="user" ? 'selected' :'' %>>user</option>
                                                        <option value="admin" <%=searchobj.status=="admin" ? 'selected' :'' %>>admin</option>
                                                        <option value="super-admin" <%=searchobj.status=="super-admin" ? 'selected' :'' %>>superadmin</option>
                                                        <option value="block-User" <%=searchobj.status=="block-User" ? 'selected' :'' %>>blockUser</option>

                                                    </select>
                                            </div>
                                            <div class="col-md-4">

                                                <div class="text-center">
                                                    <label></label> <br>
                                                    <button type="submit" class="btn btn-primary">Submit</button>
                                                    <a href="/all-user"> <button type="button"
                                                            class="btn btn-secondary">Reset</button></a>
                                                </div>
                                            </div>
                                        </form>

                                    </div>
                                </div>




                                <div class="card">
                                    <div class="card-body">
                                        <h5 class="card-title">Order List</h5>

                                        <table class="table datatable">
                                            <thead>
                                                <tr>
                                                    <th scope="col">#</th>
                                                    <th scope="col">Name</th>
                                                    <th scope="col">phone</th>
                                                    <th scope="col">email</th>
                                                    <th scope="col">gender</th>
                                                    <th scope="col">image</th>
                                                    <th scope="col">Order</th>
                                                    <th scope="col">Status</th>

                                                    <th scope="col">Action</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <% let i=0 %>
                                                    <% for( data of data) { %>
                                                        <tr>
                                                            <th scope="row">
                                                                <%= ++i %>
                                                            </th>
                                                            <td>
                                                                <%= data.name %>
                                                            </td>
                                                            <td>
                                                                <%= data.phone %>
                                                            </td>
                                                            <td>
                                                                <%= data.email %>
                                                                    <!-- <button type="button" value="<%=data._id%>"
                                                                    onclick="cartData(this)" class="btn btn-info"><i
                                                                        class="bi bi-eye"></i></button> -->

                                                            </td>
                                                            <td>
                                                                <%= data.gender %>
                                                            </td>
                                                            <td>
                                                                <% if(typeof data.image !=="undefined" && data.image!=""
                                                                    ){%>
                                                                    <img src="<%= data.image %>" alt="image"
                                                                        class="rounded-circle"
                                                                        style="width: 40px; height: 50px;border-radius: 50%;">
                                                                    <%}else{%>
                                                                        <img src="https://www.shutterstock.com/image-vector/default-avatar-profile-icon-social-260nw-1906669723.jpg"
                                                                            alt="image" class="rounded-circle"
                                                                            style="width: 40px; height: 50px;border-radius: 50%;">
                                                                        <%}%>


                                                            </td>
                                                            <td>
                                                                <% if(typeof data.numberOfOrder !=="undefined" &&
                                                                    data.numberOfOrder!="" ){%>
                                                                    <a href="/get-All-order?userId=<%= data._id %>">
                                                                        <%= data.numberOfOrder %> viwes
                                                                            order
                                                                    </a>
                                                                    <%}else{%>
                                                                        <a href="#">
                                                                            no order
                                                                        </a>
                                                                        <%}%>
                                                            </td>
                                                            <td>
                                                                <%= data.type %>
                                                            </td>
                                                            <td>
                                                                <% if( data.type=="block-User" ){%>
                                                                    <a href="/add_service?id=<%= data._id%>"
                                                                        class="btn btn-dark">
                                                                        unBlock
                                                                    </a>
                                                                    <%}else if( data.type=="super-admin" ){%>
                                                                        <a href="/Admin-Order-Approve?id=<%= data._id%>"
                                                                            class="btn btn-dark">
                                                                            Super Admin
                                                                        </a>


                                                                        <%}else if( data.type=="admin" ){%>
                                                                            <a href="/warningpage?id=<%=data._id%>" class="btn btn-danger">
                                                                                Warning
                                                                            </a>
                                                                            <a href="/Block-User?id=<%=data._id%>"
                                                                                class="btn btn-danger">
                                                                                block
                                                                            </a>
                                                                            <%}else{%>
                                                                                <a href="/Block-User?id=<%=data._id%>"
                                                                                    class="btn btn-danger">
                                                                                    block
                                                                                </a>
                                                                                <%}%>
                                                            </td>
                                                        </tr>

                                                        <%}%>
                                            </tbody>
                                        </table>
                                        <!-- End Table with stripped rows -->

                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                </section>


            </main>



            <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel"
                aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="exampleModalLabel">User Service Data</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body" id="moduleDataAppend">
                            ...
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                            <!-- <button type="button" class="btn btn-primary">Save changes</button> -->
                        </div>
                    </div>
                </div>
            </div>


            <script>
                function cartData(data) {
                    let num = data.value;
                    $.ajax({
                        type: 'get',
                        data: { "id": num },
                        url: '/Find-date-for-admin-module',
                        success: function (data) {
                            if (data.length > 0) {
                                $('#moduleDataAppend').empty()
                                let abc = ` <table class="table datatable">
                                    <thead>
                                        <tr>
                                        <th scope="col">serviceId</th>
                                        <th scope="col">quantity</th>
                                        <th scope="col">Amount</th>
                                        <th scope="col">timePeriod </th>
                                        </tr>
                                    </thead>
                                    <tbody>`
                                data.forEach((item) => {
                                    abc += `<tr>
                                        <td scope="row">${item.service.ServiceName}</td>
                                        <td>${item.cartdata.quantity}</td>
                                        <td>${item.cartdata.Amount}</td>
                                        <td>${item.cartdata.timePeriod_in_minits}</td>
                                    </tr>`
                                })
                                abc += `</tbody> </table >`
                                $('#moduleDataAppend').append(abc)
                                $("#exampleModal").modal("toggle");
                            } else {
                                alert("data not Found")
                            }
                        }
                    })
                }
            </script>
            <%- include("../../partials/script.ejs") %>
</body>

</html>